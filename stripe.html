
<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
<meta charset="UTF-8">
<title>#HelpKyoAniHeal - 袖口的京阿尼集金頁面 ♡</title>
<meta property="og:title" content="#HelpKyoAniHeal - 袖口的京阿尼集金頁面 ♡" />
<meta property="og:url" content="https://shouko.tw/HelpKyoAniHeal/" />
<meta property="og:image" content="https://shouko.tw/HelpKyoAniHeal/og.png" />
<style>
body {
  font-family: sans-serif;
  text-align: center;
  max-width: 400px;
  margin: 0 auto;
  padding: 0 10px;
}

.amount {
  font-size: 36px;
  margin: 15px auto;
}

#amount {
  width: 50%;
  font-size: 36px;
}

#pay {
  font-size: 30px;
  border-radius: 18px;
  padding: 10px 30px;
}

li {
  text-align: left;
  width: 90%;
  margin-left: 5%;
}
</style>
</head>
<body>
<script src="https://js.stripe.com/v3/"></script>
<h2>#HelpKyoAniHeal</h2>
<h3>袖口的京阿尼集金頁面 ♡</h3>
<ul>
    <li>本付款頁面為袖口提供</li>
    <li>用於方便海外朋友捐助京都動畫事件</li>
    <li>手續費遠優於臨櫃跨國匯款</li>
    <li><b>僅提供認識袖口或有共同好友的人使用</b></li>
    <li>刷卡交易幣別為日幣</li>
    <li>金流平台 Stripe 抽取 3.6% 手續費</li>
    <li>集金完成後，將一併匯款至<a href="http://www.kyotoanimation.co.jp/information/?id=3075" target="_blank">官方帳戶</a></li>
    <li>若有疑問請詢問袖口或<a href="https://www.facebook.com/joyful.cuff/" target="_blank">粉專</a></li>
</ul>
<div class="amount">¥ <input id="amount" value="10000" /></div>
<button id="pay">確定金額</button>
<div id="error-message"></div>
<script>
if (document.location.href.indexOf('?success') !== -1) {
  alert('付款成功!');
  resetQuery();
}
if (document.location.href.indexOf('?cancel') !== -1) {
  alert('已取消，請重新操作!');
  resetQuery();
}

var STRIPE_KEY = isProdMode() ? 'pk_live_EZvU6ScaNOSiQEAQDCAvrAc1' : 'pk_test_FUMsFGXFsrbXVRm3jKAnkqv0';
var stripe = Stripe(STRIPE_KEY);

document.getElementById('pay').addEventListener('click', function () {
  stripe.redirectToCheckout({
    items: [{sku: getSku(), quantity: getAmount()}],
    successUrl: 'https://shouko.tw/HelpKyoAniHeal/?success',
    cancelUrl: 'https://shouko.tw/HelpKyoAniHeal/?cancel',
  })
  .then(function (result) {
    if (result.error) {
      document.getElementById('error-message').textContent = result.error.message;
    }
  });
});

function getAmount() {
  return Math.abs(document.getElementById('amount').value) || 10000;
}

function getSku() {
  return isProdMode() ? 'sku_FVY36M2br3ZGBt' : 'sku_FVXj65sBSfMIz1';
}

function isProdMode() {
  return document.location.href.indexOf('?test') == -1
}

function resetQuery() {
  document.location.href = './';
}
</script>
</body>
</html>
